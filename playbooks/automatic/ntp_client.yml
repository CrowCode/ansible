- name: Configure NTP client
  hosts: all
  sudo: True
  tasks:

  ## Install packages
  - pacman: name=ntp
    when: ansible_distribution in ['Archlinux', 'Manjaro']

  - dnf: name=ntp
    when: ansible_distribution == 'Fedora'

  - apt: name=ntp
    when: ansible_distribution in ['Debian', 'Linuxmint', 'Ubuntu']

  - yum: name=ntp
    when: ansible_distribution == 'CentOS'


  ## Copy ntp.conf
  - name: Copy ntp.conf
    copy: src=../files/ntp_client/ntp.conf dest=/etc/ntp.conf owner=root group=root mode=755
    when: ansible_distribution in ['Archlinux', 'CentOS', 'Fedora', 'Manjaro']
    notify: restart ntpd

  - name: Copy ntp.conf
    copy: src=../files/ntp_client/ntp.conf dest=/etc/ntp.conf owner=root group=root mode=755
    when: ansible_distribution in ['Debian', 'Linuxmint', 'Ubuntu']
    notify: restart ntp


  ## Set up the daemon
  - name: Enable and start daemon (ntpd)
    service: name=ntpd enabled=yes state=started
    when: ansible_distribution in ['Archlinux', 'CentOS', 'Fedora', 'Manjaro']

  - name: Enable and start daemon (ntp)
    service: name=ntp enabled=yes state=started
    when: ansible_distribution in ['Debian', 'Linuxmint', 'Ubuntu']


  handlers:
  - name: restart ntp
    service: name=ntp state=restarted

  - name: restart ntpd
    service: name=ntpd state=restarted
