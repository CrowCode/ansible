- name: Configure sudoers
  hosts: workstations:servers
  become: True
  tasks:


  ## Ensure sudo package is installed
  - apt: name=sudo
    when: ansible_distribution in ['Debian', 'Linuxmint', 'Ubuntu']

  - dnf: name=sudo
    when: ansible_distribution == "Fedora"

  - pacman: name=sudo
    when: ansible_distribution in ['Archlinux', 'Manjaro']

  - yum: name=sudo
    when: ansible_distribution == "CentOS"


  ## Manage sudoers file
  - name: Create admins group
    group: name=admins system=yes state=present gid=901

  - name: Add jay to admins group
    user: name=jay groups=admins append=yes

  - name: Make sure admin group is allowed in sudoers
    lineinfile: "dest=/etc/sudoers
                state=present
                regexp='^%admin' line='%admins ALL=(ALL) NOPASSWD: ALL'
                validate='/usr/sbin/visudo -cf %s'"
